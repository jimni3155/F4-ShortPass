# Worklog (2025-11-20)

## S3 로그 저장
- 평가 로그 S3 키를 `logs/evaluations/{applicant_id}/{interview_id}/{timestamp}_execution_logs.json`으로 변경하여 `linkbig-ht-06-f4` 버킷 `logs/` 프리픽스에 저장되도록 수정.
- 관련 코드: `server/services/evaluation/evaluation_service.py`.

## 평가 모델/DB 정합성
- RDS `evaluations` 테이블 타입에 맞춰 모델을 JSON 컬럼으로 수정 (역량 점수/집계/fit_analysis/onboarding_support_needed 등).
- 누락된 컬럼 추가: `transcript_s3_url`, `agent_logs_s3_url`, `evidence_s3_url`를 RDS에 DDL로 추가하고, 기록용 SQL `server/add_evaluation_s3_columns.sql` 생성.
- 평가 저장 시 FK 누락으로 인한 오류 방지: Applicant/Job/Company/InterviewSession이 없으면 테스트용 placeholder를 생성 후 flush.

## 평가 저장 로직
- LangGraph 결과 dict를 JSON 컬럼에 그대로 저장하도록 변경(기존 overall_score만 넣던 로직 제거).
- 증거 JSON은 `evaluations/{interview_id}/evidence.json`으로 S3 업로드 후 URL 저장.

## 테스트/현황
- 평가 파이프라인 실행 시 S3 업로드 및 RDS INSERT 정상 완료 (최근 FK 오류 해결 후 성공).
- S3 루트 프리픽스: `evaluation-logs/`, `jd_pdfs/`, `personas/`, `portfolios/`, `test-data/`; 평가용 로그는 `logs/` 경로 사용.
